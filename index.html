<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="http://192.168.1.11/layui/css/layui.css">
    <link rel="stylesheet" href="http://192.168.1.11/css/baguetteBox.css">
    <link rel="stylesheet" href="http://192.168.1.11/css/style.css">
    <title>vue-edu</title>
  </head>
  <body>
    <div id="app"></div>
    <!-- built files will be auto injected -->
  </body>
  <script type="text/javascript" src="https://unpkg.com/vue@2.3.4/dist/vue.js"></script>
  <script src="http://192.168.1.11/layui/layui.all.js"></script>
  <script src="http://192.168.1.11/jquery.min.js"></script>
  <script src="http://192.168.1.11/baguetteBox.js"></script>
  <script>
    //JavaScript代码区域
    $(function(){
      index.init();
    })
    var index = {
      host:"",
      init:()=>{
        layui.element.init();
        layui.use('element', function(){
          var element = layui.element;
          element.init()
        });
      },
      flow: () => {
        layui.use('flow', function () {
          var flow = layui.flow;
          flow.lazyimg({
            elem: '[name=flow]'
            , scrollElem: '[name=flow]'
          });
        });
      },
      form:()=>{
        layui.use('form', function(){
          var form = layui.form;
          //
          // //监听提交
          // form.on('submit(formDemo)', function(data){
          //   layer.msg(JSON.stringify(data.field));
          //   return false;
          // });
        });
      },
      upload:()=>{
        layui.use('upload', function() {
          var $ = layui.jquery
            , upload = layui.upload;

          //普通图片上传
          var uploadInst = upload.render({
            elem: '[name=img]'
            , url: '/upload/img'
            , before: function (obj) {
              //预读本地文件示例，不支持ie8
              obj.preview(function (index, file, result) {
                $('#img').attr('src', result); //图片链接（base64）
              });
            }
            , done: function (res) {
              console.log(res)
              //如果上传失败
              if (!res.success) {
                return layer.msg('上传失败');
              }
              $('#imgUrl').html(index.host + res.result);
              $('#imgUrl').click()
              //上传成功
            }
            , error: function () {
              //演示失败状态，并实现重传
              var demoText = $('#imgText');
              demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-mini demo-reload">重试</a>');
              demoText.find('.demo-reload').on('click', function () {
                uploadInst.upload();
              });
            }
          });
          upload.render({
            elem: '[name=audio]'
            ,url: '/upload/audio'
            ,accept: 'audio' //音频
            ,done: function(res){
              console.log(res)
              //如果上传失败
              if (!res.success) {
                return layer.msg('上传失败');
              }
              $('#audioUrl').html(index.host + res.result);
              $('#audioUrl').click()
              //上传成功
            }
          });
        })
      },
      table:()=>{
        layui.use('table', function(){
          var table = layui.table;
          //第一个实例
          table.render({
            elem: '#cardlist'
            ,height: 615
            ,limit: 20
            ,url: '/card/list/' //数据接口
            ,page: true //开启分页
            ,cols: [[ //表头
              {field: 'id', title: '序号', width:100, sort: true, fixed: 'left'}
              ,{field: 'cardname', title: '卡片名称', width:180}
              ,{field: 'img', title: '卡片', width:180, sort: true}
              ,{field: 'type', title: '类型', width:180}
              ,{field: 'url', title: '卡片链接', width: 350}
              ,{field: 'mp3url', title: '音频链接', width: 350}
            ]]
          });

        })
      }
    }
  </script>
</html>
